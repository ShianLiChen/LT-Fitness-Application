{% extends "base.html" %}

{% block content %}
<div class="row justify-content-center">
    <div class="col-md-5">

        <!-- -------------------------
             Forgot Password Header
        ------------------------- -->
        <h2 class="mb-4">Forgot Password</h2>

        <!-- -------------------------
             Password Reset Form
        ------------------------- -->
        <form id="forgotPasswordForm">
            <div class="mb-3">
                <label for="email" class="form-label">Enter your email</label>
                <input type="email" class="form-control" id="email" required>
            </div>
            <button type="submit" class="btn btn-primary">Send Reset Link</button>
        </form>

        <!-- -------------------------
             Feedback Message Area
        ------------------------- -->
        <div id="forgotMessage" class="mt-3"></div>

    </div>
</div>

<!-- -------------------------
     Script: Handle Forgot Password Form
------------------------- -->
<script>
/**
 * @description Handles the submission of the forgot password form.
 * Prevents default form submission, sends a POST request with the email,
 * and displays feedback messages in the UI.
 */
async function submitForgotPassword(event) {
    event.preventDefault();

    const email = document.getElementById('email').value;
    const msgDiv = document.getElementById('forgotMessage');

    try {
        const res = await fetch('/auth/forgot-password', {
            method: 'POST',
            headers: {'Content-Type': 'application/json'},
            body: JSON.stringify({ email })
        });

        const data = await res.json();

        if (res.ok) {
            msgDiv.className = 'alert alert-success';
            msgDiv.innerText = data.message;
        } else {
            msgDiv.className = 'alert alert-danger';
            msgDiv.innerText = data.error || 'Something went wrong';
        }
    } catch (err) {
        msgDiv.className = 'alert alert-danger';
        msgDiv.innerText = 'Network error. Please try again.';
        console.error(err);
    }
}

// -------------------------
// Event Listener
// -------------------------
document.getElementById('forgotPasswordForm')
    .addEventListener('submit', submitForgotPassword);
</script>
{% endblock %}
